# üó∫Ô∏è Implementation Plan: Archive Duplicate Finder Evolution

This document outlines the roadmap to transform **Archive Duplicate Finder** from a CLI tool into an advanced 3D-aware asset management system.

---

## üõ†Ô∏è Phase 1: Performance & Persistence (Foundation)
*Focuses on Point 6 and prepares the ground for caching.*

### 1.1 Local Database Integration (SQLite)
- **Objective:** Avoid re-scanning files that haven't changed.
- **Tasks:**
  - Implement a `internal/database` package using `modernc.org/sqlite`.
  - Store `file_path`, `size`, `mod_time`, `hash`, and `stl_metadata`.
  - Add logic to verify `mod_time` and `size` before re-hashing a file.

### 1.2 File System Watcher
- **Objective:** Real-time background indexing.
- **Tasks:**
  - Integrate `fsnotify` to monitor the target directory.
  - Automatically queue new or modified archives for analysis in a low-priority background worker.

---

## üõ†Ô∏è Phase 2: Advanced Fingerprinting & Content Intelligence
*Focuses on Points 2 and 4.*

### 2.1 Geometry Voxel Hashing
- **Objective:** Identify models that are geometrically the same despite different file formats or minor scaling/rotation.
- **Tasks:**
  - Normalize STL coordinates (Translate to origin, Scale to unit cube).
  - Quantize space into a 32x32x32 grid (Voxels).
  - Generate a hash based on occupied voxels ("Voxel Hash").

### 2.2 Content Analyzer + Render Discovery
- **Objective:** Better understanding of archive contents.
- **Tasks:**
  - Improved multi-volume detection (verify if `part1` to `partN` are all present).
  - **Render Extractor:** Automatically search for and extract the largest image file (`.jpg`, `.png`) inside archives to use as a preview thumbnail.

---

## üõ†Ô∏è Phase 3: Extended Cleanup Features
*Focuses on Point 5.*

### 3.1 "Safe Move" & Trash Logic
- **Objective:** Reduce the risk of data loss.
- **Tasks:**
  - Implement a `--move-to "/path/trash"` flag.
  - Create a "Reference Link" feature: when deleting, leave a `.duplicate.txt` file pointing to the path of the preserved original.

---

## üõ†Ô∏è Phase 4: Web Dashboard & Visual Excellence
*Focuses on Point 1.*

### 4.1 Embedded Web Server
- **Objective:** A premium visual interface.
- **Tasks:**
  - Use `Fiber` or `Echo` to serve a modern React/Next.js dashboard.
  - Implement a REST API to fetch discovered duplicates and system stats.

### 4.2 Interactive 3D Comparison
- **Objective:** Visual verification before deletion.
- **Tasks:**
  - Integrate `Three.js` (React Three Fiber) in the web UI.
  - Allow users to "overlay" two STL models in 3D to see differences (Ghosting / Heatmap).

---

## üìà Success Metrics
- **Performance:** Scan time for 10% change in directory should be <5 seconds (cached).
- **Accuracy:** Identify >95% of duplicates even with renamed files.
- **Aesthetics:** Web dashboard should feel like a premium professional asset manager.

---
> *Plan generated by Antigravity AI.*
